<Page
    x:Name="pageRoot"
    x:Class="RedditGallery.Views.MainPage"
    DataContext="{Binding VM, RelativeSource={RelativeSource Self}}"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:RedditGallery.Views"
    xmlns:common="using:RedditGallery.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Page.Resources>
        <x:String x:Key="AppName">My Application</x:String>
        <Storyboard x:Name="_hideMenu">
            <DoubleAnimation
              Storyboard.TargetName="_content"
              Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)"
              From="250" To="0" Duration="0:0:0.3" EnableDependentAnimation="True">
                <DoubleAnimation.EasingFunction>
                    <CircleEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Name="_showMenu">
            <DoubleAnimation
              Storyboard.TargetName="_content"
              Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)"
              From="0" To="250" Duration="0:0:0.3" EnableDependentAnimation="True">
                <DoubleAnimation.EasingFunction>
                    <CircleEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </Page.Resources>

    <!--
        This grid acts as a root panel for the page that defines two rows:
        * Row 0 contains the back button and page title
        * Row 1 contains the rest of the page layout
    -->
    <Grid>
        <Grid Name="_menu" Width="250" HorizontalAlignment="Left" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <TextBlock Text="Reddit Gallery" FontSize="32" Margin="0, 20, 0, 0" HorizontalAlignment="Center"/>
            <ListView  Grid.Row="1" ItemsSource="{Binding SubReddits}" SelectionChanged="ListView_SelectionChanged">
            	<ListView.Resources>
            		<Style x:Key="ListViewItemStyle1" TargetType="ListViewItem">
            			<Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}"/>
            			<Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}"/>
            			<Setter Property="Background" Value="Transparent"/>
            			<Setter Property="TabNavigation" Value="Local"/>
            			<Setter Property="IsHoldingEnabled" Value="True"/>
            			<Setter Property="Margin" Value="0,0,18,2"/>
            			<Setter Property="HorizontalContentAlignment" Value="Left"/>
            			<Setter Property="VerticalContentAlignment" Value="Top"/>
            			<Setter Property="Template">
            				<Setter.Value>
            					<ControlTemplate TargetType="ListViewItem">
            						<ListViewItemPresenter CheckHintBrush="{ThemeResource ListViewItemCheckHintThemeBrush}" CheckBrush="{ThemeResource ListViewItemCheckThemeBrush}" ContentMargin="4,4,-18,4" ContentTransitions="{TemplateBinding ContentTransitions}" CheckSelectingBrush="{ThemeResource ListViewItemCheckSelectingThemeBrush}" DragForeground="{ThemeResource ListViewItemDragForegroundThemeBrush}" DragOpacity="{ThemeResource ListViewItemDragThemeOpacity}" DragBackground="{ThemeResource ListViewItemDragBackgroundThemeBrush}" DisabledOpacity="{ThemeResource ListViewItemDisabledThemeOpacity}" FocusBorderBrush="{ThemeResource ListViewItemFocusBorderThemeBrush}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" Padding="{TemplateBinding Padding}" PointerOverBackgroundMargin="1" ReorderHintOffset="{ThemeResource ListViewItemReorderHintThemeOffset}" SelectedPointerOverBorderBrush="{ThemeResource ApplicationPageBackgroundThemeBrush}" SelectedForeground="{ThemeResource ListViewItemSelectedForegroundThemeBrush}" SelectedPointerOverBackground="{ThemeResource ApplicationPageBackgroundThemeBrush}" SelectedBorderThickness="{ThemeResource ListViewItemCompactSelectedBorderThemeThickness}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" SelectedBackground="{ThemeResource ApplicationPageBackgroundThemeBrush}"/>
            					</ControlTemplate>
            				</Setter.Value>
            			</Setter>
            		</Style>
            		<DataTemplate x:Key="DataTemplate1">
            			<TextBlock TextWrapping="Wrap" Text="{Binding}" FontSize="24" Margin="22,10,0,10"/>
            		</DataTemplate>
            	</ListView.Resources>
            	<ListView.ItemTemplate>
            		<StaticResource ResourceKey="DataTemplate1"/>
            	</ListView.ItemTemplate>
            	<ListView.ItemContainerStyle>
            		<StaticResource ResourceKey="ListViewItemStyle1"/>
            	</ListView.ItemContainerStyle>
            </ListView>
            <TextBox Grid.Row="2" Text="{Binding SubReddit, Mode=TwoWay}"/>
        </Grid>

        <Grid Name="_content" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" RenderTransformOrigin="0.5,0.5">
            <Grid.RenderTransform>
                <CompositeTransform TranslateX="250"/>
            </Grid.RenderTransform>
            <Grid.ChildrenTransitions>
                <TransitionCollection>
                    <EntranceThemeTransition/>
                </TransitionCollection>
            </Grid.ChildrenTransitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Horizontal scrolling grid -->
            <GridView
            x:Name="itemGridView"
            AutomationProperties.AutomationId="ItemsGridView"
            AutomationProperties.Name="Items"
            TabIndex="1"
            Grid.RowSpan="2"
            Padding="116,136,116,46"
            ItemsSource="{Binding Images}"
            SelectionMode="None"
            IsSwipeEnabled="false"
            IsItemClickEnabled="True"
            ItemClick="ItemView_ItemClick" Margin="0,0,-10,0" Tapped="itemGridView_Tapped">
                <GridView.ItemTemplate>
                    <DataTemplate>
                        <Grid HorizontalAlignment="Left" Width="240" Height="180">
                            <Border Background="{ThemeResource ListViewItemPlaceholderBackgroundThemeBrush}">
                                <Image Source="{Binding Thumbnail}" Stretch="Uniform" AutomationProperties.Name="{Binding Title}"/>
                            </Border>
                        </Grid>
                    </DataTemplate>
                </GridView.ItemTemplate>
            </GridView>

            <!-- Back button and page title -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="50"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Rectangle Grid.ColumnSpan="4" Tapped="Rectangle_Tapped" Fill="DodgerBlue"/>
                <Button x:Name="backButton"
                        Style="{StaticResource NavigationBackButtonNormalStyle}"
                        VerticalAlignment="Center" Click="backButton_Click"/>
                <TextBlock x:Name="pageTitle" Text="{Binding SubReddit, Mode=TwoWay}" FontSize="32" Grid.Column="1" 
                        TextWrapping="NoWrap" VerticalAlignment="Center" IsHitTestVisible="False"/>
                <Button Grid.Column="2" Content="Sort" FontFamily="Global User Interface" >
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="New"/>
                            <MenuFlyoutItem Text="Hot"/>
                            <MenuFlyoutItem Text="Top"/>
                            <MenuFlyoutItem Text="Controversial"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>
                <Button Grid.Column="3" Content="Time" >
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Hour"/>
                            <MenuFlyoutItem Text="Day"/>
                            <MenuFlyoutItem Text="Week"/>
                            <MenuFlyoutItem Text="Month"/>
                            <MenuFlyoutItem Text="All"/>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>
            </Grid>
        </Grid>
    </Grid>
</Page>
